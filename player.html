<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:transparent;
  font-family:sans-serif;
}

/* STACK CONTAINER */
.project{
  width:162px;
}

/* EACH ROW */
.player{
  position:relative;
  height:35px;
  background:#000;
  display:flex;
  align-items:center;
  padding-left:10px;
  padding-right:8px;
}

/* rounded corners */
.player:first-child{
  border-top-left-radius:10px;
  border-top-right-radius:10px;
}
.player:last-child{
  border-bottom-left-radius:10px;
  border-bottom-right-radius:10px;
}

/* transparent separator */
.player + .player{
  border-top:2px solid transparent;
}

/* remove blue focus */
button,button:focus{
  outline:none;
  box-shadow:none;
}

/* PLAY */
.play{
  width:0;
  height:0;
  border-top:8px solid transparent;
  border-bottom:8px solid transparent;
  border-left:14px solid #8a8a8a;
  background:none;
  border-right:none;
  cursor:pointer;
  margin-right:10px;
}

/* PAUSE */
.pause{
  width:14px;
  height:16px;
  position:relative;
}
.pause::before,
.pause::after{
  content:"";
  position:absolute;
  width:4px;
  height:16px;
  background:#EDEDED;
}
.pause::after{ right:0; }

/* COUNTER */
.time{
  color:#EDEDED;
  font-size:16px;
  transform-origin:left center;
  transform:scaleY(1.35) scaleX(1.25);
  margin-right:10px;
  position:relative;
  top:-1px;
}

/* SPEAKER */
.speaker{
  width:16px;
  height:16px;
  margin-right:6px;
  position:relative;
  cursor:pointer;
  top:1px;
}

.speaker:before{
  content:"";
  position:absolute;
  width:6px;
  height:8px;
  background:#aaa;
  left:0;
  top:4px;
}

.speaker:after{
  content:"";
  position:absolute;
  width:0;
  height:0;
  border-top:8px solid transparent;
  border-bottom:8px solid transparent;
  border-left:8px solid #aaa;
  left:6px;
}

/* waves */
.waves{
  position:absolute;
  left:16px;
  top:0px;
  color:#aaa;
  font-size:14px;
  line-height:16px;
  transition:color .15s ease;
}
.waves.muted{
  color:#4C4C4C;
}

/* FADER */
input[type=range]{
  -webkit-appearance:none;
  width:55px;
  height:6px;
  margin-left:auto;
  background:linear-gradient(to right,#888 80%,#4C4C4C 80%);
  border-radius:4px;
  cursor:pointer;
  position:relative;
  top:1px;
}

input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:10px;
  height:10px;
  background:#ccc;
  border-radius:50%;
}
</style>
</head>

<body>

<div class="project" id="project"></div>

<script>
const project = document.getElementById("project");

/* READ URL */
const params = new URLSearchParams(window.location.search);
const srcList = (params.get("src") || "").split(",").filter(Boolean);

/* CREATE ROWS */
srcList.forEach(src=>{
  const row = document.createElement("div");
  row.className = "player";
  row.innerHTML = `
    <button class="play"></button>
    <div class="time">0:00</div>
    <div class="speaker"><div class="waves">)))</div></div>
    <input type="range" min="0" max="1" step="0.01" value="0.8">
    <audio src="${src}"></audio>
  `;
  project.appendChild(row);
});

const players = document.querySelectorAll(".player");

players.forEach(p=>{
  const btn = p.querySelector("button");
  const audio = p.querySelector("audio");
  const time = p.querySelector(".time");
  const speaker = p.querySelector(".speaker");
  const waves = p.querySelector(".waves");
  const fader = p.querySelector("input");

  audio.volume = fader.value;

  btn.addEventListener("click",()=>{
    if(audio.paused){

      /* stop others */
      players.forEach(other=>{
        const a = other.querySelector("audio");
        const b = other.querySelector("button");
        if(a !== audio){
          a.pause();
          b.className = "play";
        }
      });

      audio.play();
      btn.className = "pause";
    }else{
      audio.pause();
      btn.className = "play";
    }
  });

  audio.addEventListener("timeupdate",()=>{
    const m = Math.floor(audio.currentTime/60);
    const s = Math.floor(audio.currentTime%60).toString().padStart(2,'0');
    time.textContent = m+":"+s;
  });

  fader.addEventListener("input",()=>{
    audio.volume = fader.value;
    const v = fader.value*100;
    fader.style.background = `linear-gradient(to right,#888 ${v}%,#4C4C4C ${v}%)`;
  });

  speaker.addEventListener("click",()=>{
    audio.muted = !audio.muted;
    waves.classList.toggle("muted", audio.muted);
  });
});
</script>

</body>
</html>
